<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>By Selim - Atƒ±f Zinciri G√∂rselle≈ütirici</title>
    <script src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.css">
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #f6f8fa, #e9efff);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #222;
        }

        h1 {
            margin-top: 20px;
            color: #2b4eff;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }

        #controls {
            margin: 20px;
            display: flex;
            flex-direction: row;
            gap: 10px;
        }

        input {
            padding: 10px;
            font-size: 1em;
            border-radius: 8px;
            border: 1px solid #ccc;
            width: 280px;
        }

        button {
            padding: 10px 20px;
            background: #2b4eff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background: #1c36c5;
        }

        #network {
            width: 90%;
            height: 550px;
            border-radius: 12px;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        #status {
            margin: 15px;
            font-weight: 500;
        }

        #spinner {
            display: none;
            margin-top: 10px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #2b4eff;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            100% { transform: rotate(360deg); }
        }

        #notes {
            font-size: 0.9em;
            color: #555;
            margin-top: 20px;
            max-width: 700px;
            text-align: center;
            background: rgba(43,78,255,0.05);
            border-radius: 10px;
            padding: 10px 15px;
        }
    </style>
</head>
<body>

    <h1>By Selim - Atƒ±f Zinciri G√∂rselle≈ütirici</h1>

    <div id="controls">
        <input id="paperInput" type="text" placeholder="Makale DOI'si girin (√∂rnek: 10.1038/nature12373)">
        <button id="searchButton">Ara</button>
    </div>

    <div id="spinner"></div>
    <div id="status"></div>
    <div id="network"></div>

    <div id="notes">
        üîπ DOI numarasƒ±nƒ± girip ‚ÄúAra‚Äù tu≈üuna basƒ±n.<br>
        üîπ Mavi d√ºƒü√ºmler kaynak√ßa (references), ye≈üiller atƒ±f yapan makalelerdir.<br>
        üîπ K√∂k makale turuncu renkle g√∂sterilir.<br>
        üîπ Kaynak bulunamazsa sistem otomatik olarak CrossRef √ºzerinden dener.
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchButton = document.getElementById('searchButton');
            const paperInput = document.getElementById('paperInput');
            const networkContainer = document.getElementById('network');
            const status = document.getElementById('status');
            const spinner = document.getElementById('spinner');

            const options = {
                nodes: { shape: 'dot', size: 18, font: { size: 14 }, borderWidth: 2 },
                edges: { width: 2, arrows: { to: { enabled: true, scaleFactor: 0.5 } } },
                physics: { solver: 'barnesHut', barnesHut: { gravitationalConstant: -3000 } }
            };

            searchButton.onclick = () => searchPaper();
            paperInput.onkeyup = (e) => { if (e.key === 'Enter') searchPaper(); };

            async function searchPaper() {
                const doi = paperInput.value.trim();
                if (doi === '') {
                    status.textContent = '‚ö†Ô∏è L√ºtfen bir DOI girin.';
                    return;
                }

                status.textContent = 'üîç Makale aranƒ±yor...';
                spinner.style.display = 'inline-block';

                try {
                    // √ñnce Semantic Scholar API
                    const apiUrl = `https://api.semanticscholar.org/graph/v1/paper/DOI:${encodeURIComponent(doi)}?fields=title,year,authors,references.title,references.paperId,citations.title,citations.paperId`;
                    let response = await fetch(apiUrl);
                    let data;

                    if (!response.ok) {
                        // Eƒüer Semantic Scholar ba≈üarƒ±sƒ±zsa CrossRef'e ba≈üvur
                        const crossRefUrl = `https://api.crossref.org/works/${encodeURIComponent(doi)}`;
                        response = await fetch(crossRefUrl);
                        if (!response.ok) throw new Error("Makale bulunamadƒ± veya API eri≈üimi ba≈üarƒ±sƒ±z oldu.");
                        const crossData = await response.json();
                        data = {
                            title: crossData.message.title[0],
                            year: crossData.message.published?.['date-parts']?.[0]?.[0] || "Yƒ±l bilgisi yok",
                            references: [],
                            citations: []
                        };
                    } else {
                        data = await response.json();
                    }

                    drawGraph(data);
                    status.textContent = `‚úÖ "${data.title}" i√ßin g√∂rselle≈ütirme olu≈üturuldu.`;
                } catch (err) {
                    console.error(err);
                    status.textContent = `‚ùå Hata: ${err.message}. L√ºtfen DOI'yi kontrol edin veya daha sonra tekrar deneyin.`;
                } finally {
                    spinner.style.display = 'none';
                }
            }

            function drawGraph(data) {
                const nodes = [];
                const edges = [];

                nodes.push({
                    id: data.paperId || 'root',
                    label: `[ANA MAKALE]\n${(data.title || 'Ba≈ülƒ±k yok').substring(0, 30)}...`,
                    title: data.title,
                    color: '#f0a30a',
                    size: 30
                });

                if (data.references?.length) {
                    data.references.forEach(ref => {
                        if (ref.paperId) {
                            nodes.push({
                                id: ref.paperId,
                                label: ref.title?.substring(0, 30) + '...',
                                color: '#4285F4'
                            });
                            edges.push({ from: data.paperId, to: ref.paperId });
                        }
                    });
                }

                if (data.citations?.length) {
                    data.citations.forEach(cit => {
                        if (cit.paperId) {
                            nodes.push({
                                id: cit.paperId,
                                label: cit.title?.substring(0, 30) + '...',
                                color: '#34A853'
                            });
                            edges.push({ from: cit.paperId, to: data.paperId });
                        }
                    });
                }

                const graphData = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
                new vis.Network(networkContainer, graphData, options);
            }
        });
    </script>

</body>
</html>
